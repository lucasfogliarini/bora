<section id="account" class="content">
  <div class="card">
    <div class="card-header">
      <nav *ngIf="!editing" class="navbar navbar-expand">
        <ul *ngIf="account?.id" class="navbar-nav">
          <li *ngIf="account.photo" class="image">
            <img style="width: 75px" [src]="account.photo" class="img-circle elevation-2" alt="User Image">
          </li>
          <li *ngIf="account.whatsApp">
            <a class="nav-link" target="_blank" href="https://api.whatsapp.com/send/?phone=55{{account.whatsApp}}&text=Oi {{account.name}}, te encontrei na divagando… bora fazer algo?" role="button"><fa-icon [icon]="['fab','whatsapp']"></fa-icon></a>
          </li>
          <li *ngIf="account.instagram">
            <a class="nav-link" target="_blank" href="https://instagram.com/{{account.instagram}}" role="button"><fa-icon [icon]="['fab','instagram']"></fa-icon></a>
          </li>
          <li *ngIf="account.spotify">
            <a class="nav-link" target="_blank" href="https://open.spotify.com/user/{{account.spotify}}" role="button"><fa-icon [icon]="['fab','spotify']"></fa-icon></a>
          </li>
        </ul>
      </nav>
      <h3 *ngIf="!account">Usuário não encontrado</h3>
      <div class="editing-account" *ngIf="editing">
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fas','user']"></fa-icon>
          <input [(ngModel)]="account.name" type="text" class="form-control input-sm" placeholder="Nome" />
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fas','at']"></fa-icon>
          <input [(ngModel)]="account.username" type="text" class="form-control input-sm" placeholder="Usuário Divagando" (keydown.space)="$event.preventDefault();" />
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fab','instagram']"></fa-icon>
          <input [(ngModel)]="account.instagram" type="text" class="form-control input-sm" placeholder="Usuário Instagram" (keydown.space)="$event.preventDefault();" />
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fab','whatsapp']"></fa-icon>
          <input [(ngModel)]="account.whatsApp" type="number" class="form-control input-sm" placeholder="51987654321" />
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fab','spotify']"></fa-icon>
          <input [(ngModel)]="account.spotify" type="text" class="form-control input-sm" placeholder="Usuário Spotify" (keydown.space)="$event.preventDefault();" />
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fas','camera']"></fa-icon>
          <button (click)="openGoogleConta()" class="btn btn-dark form-control">Alterar foto no Google</button>
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fas','calendar-day']"></fa-icon>
          <button *ngIf="!authService.account.calendarAuthorized" (click)="authService.authorizeCalendar()" class="btn-success btn form-control">Autorizar Google Agenda</button>
          <button *ngIf="authService.account.calendarAuthorized" (click)="authService.unauthorizeCalendar()" class="btn-secondary btn form-control">Desautorizar Google Agenda</button>
        </div>
        <div class="d-flex mb-2">
          <fa-icon class="mr-2" [icon]="['fas','calendar-plus']"></fa-icon>
          <div class="custom-control custom-switch mt-2">
            <input id="createEventEnabled" [(ngModel)]="account.createEventEnabled" type="checkbox" class="custom-control-input">
            <label class="custom-control-label" for="createEventEnabled"></label>
          </div>
        </div>
        <button (click)="updateAccount()" class="btn-dark btn">Salvar</button>
        <button (click)="editing=false" class="btn-white btn">Cancelar</button>
      </div>
    </div>
    <div class="card-body p-0">
      <app-events></app-events>
    </div>
  </div>
</section>

<div id="order-questions" *ngIf="account?.calendarAuthorized">
  <div *ngIf="account.createEventEnabled && !account.createOrderEnabled">
    <app-event-create></app-event-create>
    <fa-icon (click)="createEvent()" *ngIf="!inProgress()" id="bora" [icon]="['fas','comments']" role="button" class="col-6"></fa-icon>    
  </div>
  <div *ngIf="account?.createEventEnabled && account.createOrderEnabled">    
    <app-event-create></app-event-create>
    <app-event-order></app-event-order>
    <fa-icon *ngIf="!inProgress()" id="bora" [icon]="['fas','comments']" mwlConfirmationPopover
        title="Bora ..."
        popoverTitle="Bora ..."
        popoverMessage="Um <b>Encontro</b> ou um <b>Pedido</b> em um encontro <br /> <small>É necessário se autenticar no Google.</small>"
        placement="left"
        confirmText="Encontro"
        (confirm)="createEvent()"
        cancelText="Pedido"
        (cancel)="createOrder()"
        role="button"
        class="col-6"></fa-icon>
  </div>
</div>
